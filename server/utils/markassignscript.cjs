[200~#!/usr/bin/env node
/**
 * Student Review Updater - Node.js Version for BTech only
  * Uses individual PUT /:regNo endpoint for each BTech student
   * Processes ALL BTech students with component-level marks
    */

    const XLSX = require('xlsx');
    const axios = require('axios');
    const fs = require('fs');
    const readline = require('readline');

    // Configuration
    const EXCEL_FILE_PATH = '/home/administrator/Desktop/excel-files/Upload/student_mark_assign.xlsx';
    const API_BASE_URL = 'http://localhost:5000/api/student';
    const AUTH_TOKEN = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4Zjg5N2JlMjJiN2QwODQ3NDRmNjU0OCIsImVtYWlsSWQiOiJhZG1pbkB2aXQuYWMuaW4iLCJlbXBsb3llZUlkIjoiQURNSU4wMDEiLCJyb2xlIjoiYWRtaW4iLCJpYXQiOjE3NjE2NzcwOTMsImV4cCI6MTc2MTc2MzQ5M30.8gftdd6WoUdWw0l8Gho61KDzqlI7hQJQ4rOZ5o6mZGc';

    class StudentReviewUpdater {
    	    constructor(excelFilePath, apiBaseUrl, authToken, dryRun = false) {
    	    	        this.excelFilePath = excelFilePath;
    	    	                this.apiBaseUrl = apiBaseUrl;
    	    	                        this.authToken = authToken;
    	    	                                this.dryRun = dryRun;

    	    	                                        this.componentMapping = {
    	    	                                        	            'BTech': {
    	    	                                        	            	                'draftReview': {
    	    	                                        	            	                	                    excelPrefix: 'Zero-th Review',
    	    	                                        	            	                	                                        components: ['Title & Problem Statement'],
    	    	                                        	            	                	                                                            isDummy: true
    	    	                                        	            	                	                                                                            },
    	    	                                        	            	                	                                                                                            'panelReview1': {
    	    	                                        	            	                	                                                                                            	                    excelPrefix: 'Review 1',
    	    	                                        	            	                	                                                                                            	                                        components: [
    	    	                                        	            	                	                                                                                            	                                        	                        'Problem Statement & Motivation',
    	    	                                        	            	                	                                                                                            	                                        	                                                'Literature Review & Gap Identification',
    	    	                                        	            	                	                                                                                            	                                        	                                                                        'Objective & Scope',
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                'Proposed methodology & Feasability',
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                        'Presentation & Communication'
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                            ],
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                isDummy: false
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                },
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                'guideReview1': {
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                    excelPrefix: 'Dummy ',
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                        components: ['test'],
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                            isDummy: true
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                            }
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                        }
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                };

    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                        this.failedUpdates = [];
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                this.successfulUpdates = [];
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                        this.totalStudentsProcessed = 0;
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                this.totalReviewsSkipped = 0;
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                        this.logFile = `update_log_${new Date().toISOString().replace(/[:.]/g, '-')}.log`;
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                            }

    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                log(message, level = 'INFO') {
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	        const timestamp = new Date().toISOString();
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                const logMessage = `${timestamp} - ${level} - ${message}`;
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                        console.log(logMessage);
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                fs.appendFileSync(this.logFile, logMessage + '\n');
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                    }

    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        loadExcelData() {
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        try {
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	            this.log(`Loading Excel file: ${this.excelFilePath}`);
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                        const workbook = XLSX.readFile(this.excelFilePath);
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                    this.sheetData = {};

    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                for (const sheetName of workbook.SheetNames) {
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                if (!sheetName.includes('BTech')) continue;
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                const worksheet = workbook.Sheets[sheetName];
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                const jsonData = XLSX.utils.sheet_to_json(worksheet);
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                this.sheetData[sheetName] = jsonData;
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                this.log(`Loaded sheet '${sheetName}' with ${jsonData.length} students`);
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                            }

    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        if (Object.keys(this.sheetData).length === 0) {
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                this.log('No BTech sheet found in Excel file', 'ERROR');
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                return false;
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                            }
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                        return true;
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                } catch (error) {
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	            this.log(`Failed to load Excel file: ${error.message}`, 'ERROR');
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                        return false;
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                }
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                    }

    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        extractComponentMarks(row, reviewConfig, excelPrefix) {
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	        const componentMarks = {};
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                for (const componentName of reviewConfig.components) {
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	            const colName = `${excelPrefix}_${componentName}`;
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        if (row[colName] !== undefined && row[colName] !== null && row[colName] !== '') {
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                const mark = parseFloat(row[colName]);
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                if (!isNaN(mark)) {
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                    componentMarks[componentName] = mark;
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                    }
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                }
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                        }
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                return componentMarks;
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                    }

    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        processStudentRow(row) {
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	        const regNo = String(row['Register No'] || '').trim();
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                const studentName = String(row['Name'] || '').trim();
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        if (!regNo) {
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	            this.log('Skipping row with no valid registration number', 'WARN');
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                        return null;
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                }
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                        this.log(`Processing: ${studentName} (${regNo})`);

    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                const patDetected = String(row['PAT_Detected'] || '').toLowerCase() === 'yes';
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                        const deptMapping = this.componentMapping['BTech'];
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                const marksUpdate = [];

    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        for (const [reviewName, reviewConfig] of Object.entries(deptMapping)) {
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            if (reviewConfig.isDummy) {
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                this.totalReviewsSkipped++;
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                continue;
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                            }
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                        const componentMarks = this.extractComponentMarks(row, reviewConfig, reviewConfig.excelPrefix);
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                    const comments = row[`${reviewConfig.excelPrefix}_Comments`] || '';
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                const attendancePresent = String(row[`${reviewConfig.excelPrefix}_Attendance`] || '').toLowerCase() === 'present';

    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            marksUpdate.push({
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                reviewName,
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                marks: componentMarks,
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                comments: String(comments).trim(),
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                attendance: { value: attendancePresent, locked: false },
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                locked: false
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                            });

    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                        const marksSum = Object.values(componentMarks).reduce((a, b) => a + b, 0);
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                    this.log(`   ${reviewName}: ${Object.keys(componentMarks).length} components, Marks: ${marksSum}, Status: ${attendancePresent ? 'Present' : 'Absent'}`);
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                            }

    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    return {
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	            regNo,
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                        name: studentName,
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                    payload: { marksUpdate, PAT: patDetected }
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                            };
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                }

    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    async sendStudentUpdate(regNo, payload) {
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        if (this.dryRun) {
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	            this.log(`[DRY RUN] Would update student: ${regNo}`);
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                        return { success: true };
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                }
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        try {
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	            const url = `${this.apiBaseUrl}/${regNo}`;
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                        this.log(`PUT ${url}`);
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    const response = await axios.put(url, payload, {
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${this.authToken}` },
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                timeout: 30000
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                            });
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                        return { success: true, data: response.data };
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                } catch (error) {
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            return {
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                success: false,
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                error: error.response
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                    ? `HTTP ${error.response.status}: ${JSON.stringify(error.response.data).slice(0, 200)}`
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                        : `Request failed: ${error.message}`
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                    };
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                            }
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                }

    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    async processSheet(sheetName, data) {
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	        this.log(`Processing sheet: ${sheetName} with ${data.length} students`);
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                let processedCount = 0;

    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        for (const row of data) {
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            try {
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                const studentData = this.processStudentRow(row);
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                if (!studentData) continue;

    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                const { regNo, name, payload } = studentData;
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                const result = await this.sendStudentUpdate(regNo, payload);

    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                if (result.success) {
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                    this.successfulUpdates.push({ sheet: sheetName, reg_no: regNo, name, reviews_count: payload.marksUpdate.length });
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                        this.log(`Successfully updated: ${name} (${regNo})`);
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                            processedCount++;
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            } else {
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                    this.failedUpdates.push({ sheet: sheetName, reg_no: regNo, name, error: result.error });
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                        this.log(`Failed to update ${name} (${regNo}): ${result.error}`, 'ERROR');
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                        }

    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                        await new Promise(r => setTimeout(r, 100));
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    } catch (error) {
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                this.log(`Error processing student row: ${error.message}`, 'ERROR');
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                            }
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                    }
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                            return processedCount;
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                }

    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    async processAllSheets() {
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	        if (!this.loadExcelData()) return false;

    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                this.totalStudentsProcessed = 0;
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        for (const [sheetName, data] of Object.entries(this.sheetData)) {
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	            const count = await this.processSheet(sheetName, data);
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                        this.totalStudentsProcessed += count;
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                }

    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                        this.log(`Processed ${this.totalStudentsProcessed} students, successful: ${this.successfulUpdates.length}, failed: ${this.failedUpdates.length}, dummy reviews skipped: ${this.totalReviewsSkipped}`);
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                                return true;
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                                    }

    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                                        generateReport() {
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                                        	        const report = {
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                                        	        	            timestamp: new Date().toISOString(),
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                                        	        	                        dry_run: this.dryRun,
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                                        	        	                                    summary: {
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                                        	        	                                    	                total_students_processed: this.totalStudentsProcessed,
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                                        	        	                                    	                                total_successful: this.successfulUpdates.length,
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                                        	        	                                    	                                                total_failed: this.failedUpdates.length,
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                                        	        	                                    	                                                                total_reviews_skipped: this.totalReviewsSkipped
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                                        	        	                                    	                                                                            },
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                                        	        	                                    	                                                                                        successful_updates: this.successfulUpdates,
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                                        	        	                                    	                                                                                                    failed_updates: this.failedUpdates
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                                        	        	                                    	                                                                                                            };
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                                        	        	                                    	                                                                                                                    const reportFilename = `update_report_${new Date().toISOString().replace(/[:.]/g, '-')}.json`;
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                                        	        	                                    	                                                                                                                            fs.writeFileSync(reportFilename, JSON.stringify(report, null, 2));
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                                        	        	                                    	                                                                                                                                    this.log(`Report saved: ${reportFilename}`);

    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                                        	        	                                    	                                                                                                                                            console.log(`Processed: ${report.summary.total_students_processed}`);
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                                        	        	                                    	                                                                                                                                                    console.log(`Successful: ${report.summary.total_successful}`);
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                                        	        	                                    	                                                                                                                                                            console.log(`Failed: ${report.summary.total_failed}`);
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                                        	        	                                    	                                                                                                                                                                    console.log(`Skipped dummy reviews: ${report.summary.total_reviews_skipped}`);

    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                                        	        	                                    	                                                                                                                                                                            if (this.failedUpdates.length) {
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                                        	        	                                    	                                                                                                                                                                            	            console.log('Failures:');
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                                        	        	                                    	                                                                                                                                                                            	                        this.failedUpdates.slice(0, 10).forEach(({ name, reg_no, error }, i) =>
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                                        	        	                                    	                                                                                                                                                                            	                                        console.log(`${i + 1}. ${name} (${reg_no}): ${error}`));
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                                        	        	                                    	                                                                                                                                                                            	                                                    if (this.failedUpdates.length > 10)
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                                        	        	                                    	                                                                                                                                                                            	                                                                    console.log(`... +${this.failedUpdates.length - 10} more`);
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                                        	        	                                    	                                                                                                                                                                            	                                                                            }
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                                        	        	                                    	                                                                                                                                                                            	                                                                                    return report;
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                                        	        	                                    	                                                                                                                                                                            	                                                                                        }
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                                        	        	                                    	                                                                                                                                                                            	                                                                                        }

    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                                        	        	                                    	                                                                                                                                                                            	                                                                                        function askQuestion(query) {
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                                        	        	                                    	                                                                                                                                                                            	                                                                                        	    const rl = readline.createInterface({ input: process.stdin, output: process.stdout });
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                                        	        	                                    	                                                                                                                                                                            	                                                                                        	        return new Promise(resolve => rl.question(query, ans => {
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                                        	        	                                    	                                                                                                                                                                            	                                                                                        	        	        rl.close();
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                                        	        	                                    	                                                                                                                                                                            	                                                                                        	        	                resolve(ans);
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                                        	        	                                    	                                                                                                                                                                            	                                                                                        	        	                    }));
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                                        	        	                                    	                                                                                                                                                                            	                                                                                        	        	                    }

    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                                        	        	                                    	                                                                                                                                                                            	                                                                                        	        	                    async function main() {
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                                        	        	                                    	                                                                                                                                                                            	                                                                                        	        	                    	    console.log('Student Review Updater - BTech Only');
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                                        	        	                                    	                                                                                                                                                                            	                                                                                        	        	                    	        if (!fs.existsSync(EXCEL_FILE_PATH)) {
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                                        	        	                                    	                                                                                                                                                                            	                                                                                        	        	                    	        	        console.error(`File not found: ${EXCEL_FILE_PATH}`);
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                                        	        	                                    	                                                                                                                                                                            	                                                                                        	        	                    	        	                process.exit(1);
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                                        	        	                                    	                                                                                                                                                                            	                                                                                        	        	                    	        	                    }

    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                                        	        	                                    	                                                                                                                                                                            	                                                                                        	        	                    	        	                        console.log(`Excel: ${EXCEL_FILE_PATH}`);
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                                        	        	                                    	                                                                                                                                                                            	                                                                                        	        	                    	        	                            console.log(`API base URL: ${API_BASE_URL}/:regNo`);
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                                        	        	                                    	                                                                                                                                                                            	                                                                                        	        	                    	        	                                console.log('1. DRY RUN (test)');
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                                        	        	                                    	                                                                                                                                                                            	                                                                                        	        	                    	        	                                    console.log('2. LIVE MODE (update DB)');
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                                        	        	                                    	                                                                                                                                                                            	                                                                                        	        	                    	        	                                        const mode = await askQuestion('Select mode (1 or 2): ');
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                                        	        	                                    	                                                                                                                                                                            	                                                                                        	        	                    	        	                                            const dryRun = mode.trim() === '1';
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                                        	        	                                    	                                                                                                                                                                            	                                                                                        	        	                    	        	                                                if (!dryRun) {
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                                        	        	                                    	                                                                                                                                                                            	                                                                                        	        	                    	        	                                                	        const confirm = await askQuestion("Type 'CONFIRM' to proceed: ");
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                                        	        	                                    	                                                                                                                                                                            	                                                                                        	        	                    	        	                                                	                if (confirm.trim() !== 'CONFIRM') {
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                                        	        	                                    	                                                                                                                                                                            	                                                                                        	        	                    	        	                                                	                	            console.log('Operation cancelled');
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                                        	        	                                    	                                                                                                                                                                            	                                                                                        	        	                    	        	                                                	                	                        process.exit(0);
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                                        	        	                                    	                                                                                                                                                                            	                                                                                        	        	                    	        	                                                	                	                                }
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                                        	        	                                    	                                                                                                                                                                            	                                                                                        	        	                    	        	                                                	                	                                    }

    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                                        	        	                                    	                                                                                                                                                                            	                                                                                        	        	                    	        	                                                	                	                                        const updater = new StudentReviewUpdater(EXCEL_FILE_PATH, API_BASE_URL, AUTH_TOKEN, dryRun);
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                                        	        	                                    	                                                                                                                                                                            	                                                                                        	        	                    	        	                                                	                	                                            await updater.processAllSheets();
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                                        	        	                                    	                                                                                                                                                                            	                                                                                        	        	                    	        	                                                	                	                                                updater.generateReport();
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                                        	        	                                    	                                                                                                                                                                            	                                                                                        	        	                    	        	                                                	                	                                                    console.log('Process complete!');
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                                        	        	                                    	                                                                                                                                                                            	                                                                                        	        	                    	        	                                                	                	                                                    }

    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                                        	        	                                    	                                                                                                                                                                            	                                                                                        	        	                    	        	                                                	                	                                                    if (require.main === module) {
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                                        	        	                                    	                                                                                                                                                                            	                                                                                        	        	                    	        	                                                	                	                                                    	    main().catch(err => {
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                                        	        	                                    	                                                                                                                                                                            	                                                                                        	        	                    	        	                                                	                	                                                    	    	        console.error('Fatal error:', err);
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                                        	        	                                    	                                                                                                                                                                            	                                                                                        	        	                    	        	                                                	                	                                                    	    	                process.exit(1);
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                                        	        	                                    	                                                                                                                                                                            	                                                                                        	        	                    	        	                                                	                	                                                    	    	                    });
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                                        	        	                                    	                                                                                                                                                                            	                                                                                        	        	                    	        	                                                	                	                                                    	    	                    }

    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                                        	        	                                    	                                                                                                                                                                            	                                                                                        	        	                    	        	                                                	                	                                                    	    	                    module.exports = StudentReviewUpdater;[201~]
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                                        	        	                                    	                                                                                                                                                                            	                                                                                        	        	                    	        	                                                	                	                                                    	    })
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                                        	        	                                    	                                                                                                                                                                            	                                                                                        	        	                    	        	                                                	                	                                                    }
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                                        	        	                                    	                                                                                                                                                                            	                                                                                        	        	                    	        	                                                	                }
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                                        	        	                                    	                                                                                                                                                                            	                                                                                        	        	                    	        	                                                }
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                                        	        	                                    	                                                                                                                                                                            	                                                                                        	        	                    	        }
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                                        	        	                                    	                                                                                                                                                                            	                                                                                        	        	                    }
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                                        	        	                                    	                                                                                                                                                                            	                                                                                        	        }))
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                                        	        	                                    	                                                                                                                                                                            	                                                                                        }
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                                        	        	                                    	                                                                                                                                                                            }
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                                        	        	                                    }
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                                        	        }
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        	                                                        }
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    	                        }
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    	                                                    }
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            	                                                                                    }
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                	                                                                            }
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            	                                                                                }
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        	            }
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    	                        }
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            	                                                                                                    }
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                	            }
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    	                                                                }
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        	                                    })
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        	                                        }
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    	        }
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    	                                                    }
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            	                                                                                                                                    }
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            	                                                                                            })
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        	            }
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        	                                                                        }
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        	                        }
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                	                                                                        }
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        	                                }
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                	                        }
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        	                }
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                	                                        }
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        	                                                                }
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                	                                                                                                        }
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        	                                                }
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        	        }
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                	                                        }
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                	                                                                                                                                                }
    	    	                                        	            	                	                                                                                            	                                        	                                                                                                                                                                                                }
    	    	                                        	            	                	                                                                                            	                                        ]
    	    	                                        	            	                	                                                                                            }
    	    	                                        	            	                }
    	    	                                        	            }
    	    	                                        }
    	    }
    }]
